<!DOCTYPE html
          PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<meta charset="utf-8"/>    

<html oncontextmenu="return false" >
  <head>
    <title>Kaboom!</title>

    <meta http-equiv="content-script-type" content="text/javascript"/>
    <!-- Prevent Chrome from caching the game.js file and thus preventing its reloading when debugging -->
    <meta HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE"/>
    <meta HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-STORE"/>
    <meta HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE"/>

    <!-- iOS/mobile Settings.  Do not set width and height based on
         device-width and device-height; that makes assumptions about
         orientation -->
    <meta name="viewport" content="initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black"/>
    <meta name="apple-touch-fullscreen" content="yes" />

    <style type="text/css">
      /* Prevent selection on iOS during touch events */
      * {
        -webkit-touch-callout: none;
        -webkit-user-select: none;
      }
    </style>

    <!-- Browser compatibility -->
    <script>
      if ((navigator.userAgent.toLowerCase().indexOf('safari') == -1) &&
          (navigator.userAgent.toLowerCase().indexOf('chrome') == -1) &&
          (navigator.userAgent.toLowerCase().indexOf('iphone') == -1) &&
          (navigator.userAgent.toLowerCase().indexOf('ipad') == -1) &&
          (navigator.userAgent.toLowerCase().indexOf('ipod') == -1) &&
          (navigator.appName.toLowerCase().indexOf('internet explorer') == -1) &&
          (navigator.userAgent.indexOf("Firefox") == -1)) {
      // Note that Chrome reports itself as Safari on Mac and full-screen
      // iOS webapps report themselves as 'iPhone'
      
          alert("Please run this game in Internet Explorer 9, Chrome 25.0, Safari 6.0.2, " +
                "the iOS 5.1 Safari web browser, Firefox 19.0 or newer.");
      }

      var _ch_PLAY_VERSION = 1.4;
      
      // Make several attempts to load the codeheart.js library from different locations.
      var _ch_sourceURL;

      /** This must be called from its own script tag because it emits code 
          for other script tags. */
      function tryToLoad(url) {
         if (typeof codeheart === 'undefined') {
            // Previous attempts failed to load the script.  Try another location.
            // We can't allow the script tag itself to appear as a string in the source
            // code, so this is broken across multiple strings.

            document.write('<scr' + 'ipt src="' + url + '?refresh=1" charset="UTF-8" type="text/javascript"></scr' + 'ipt>'); 

            // Assume success
            _ch_sourceURL = url;
         } 
      }
    </script>
    <script>tryToLoad("codeheart.js");</script>
    <script>tryToLoad("../codeheart.js");</script>
    <script>tryToLoad("../../codeheart.js");</script>
    <script>tryToLoad("../../../codeheart.js");</script>
    <script>tryToLoad("http://www.codeheartjs.com/1.4/codeheart.js");</script>

    <script>
       if (typeof codeheart === 'undefined') {
           alert("You have to put codeheart.js in this directory, (" + window.location +
                 ") put it in the " + 
                 "parent directory, or have an internet connection.");
       } else {
           var s = "_______________________________________________________";
           console.log(s + s);
           console.log("\n");
           console.log("Running codeheart.js version " + codeheart.VERSION + " from " + _ch_sourceURL);
           console.log("Running play.html version " + _ch_PLAY_VERSION + " from " + window.location);
           console.log("Running game at " + ('' + window.location).substr(0, ('' + window.location).length - 'play.html'.length) + 'game.js');
           console.log("on " + navigator.userAgent);
           console.log("\n");
           console.log(s + s);
       }
    </script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-131293889-1"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'UA-131293889-1');
        </script>
  </head>

  <body oncontextmenu="return false" onload="_ch_onLoad();" style="margin: 0px; background: #000;">
    <script>_ch_makeCanvas();</script>   
  </body>

  <!-- The game code -->
  <script src="game.js?refresh=1" type="text/javascript"></script>
</html>
